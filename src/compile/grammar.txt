Goal            : RootContent $
RootContent     : Content
Content(next)   : Content Node
Content(first)  : Node

Node    : Element
Node    : Tag
Node    : Text

Element                     : "<" ElementCode
ElementCode(begin)          : ElementBeginContent ElementEnd
ElementCode(doctype)        : "!" "DOCTYPE" .ws DoctypeContent ">"
ElementEnd(single)          : "/>"
ElementEnd(block)           : ">" BlockElementContinue
BlockElementContinue        : Content BlockElementClose
BlockElementContinue(empty) : BlockElementClose
BlockElementClose           : "</" ElementNameWS ">"
ElementBeginContent(attr)   : ElementName HtmlAttributes
ElementBeginContent         : ElementName
ElementNameWS               : ElementName .ws
ElementNameWS               : ElementName
ElementName                 : HtmlName
DoctypeContent(list)        : DoctypeContent DoctypeContentItemWs
DoctypeContent(first)       : DoctypeContentItemWs
DoctypeContentItemWs        : DoctypeContentItem .ws
DoctypeContentItemWs        : DoctypeContentItem
DoctypeContentItem(name)    : HtmlName
DoctypeContentItem(qq)      : HtmlQQConst
DoctypeContentItem(q)       : HtmlQConst
HtmlAttributes(list)        : HtmlAttributes HtmlAttributeWS
HtmlAttributes(init)        : .ws
HtmlAttributeWS             : HtmlAttribute .ws
HtmlAttributeWS             : HtmlAttribute
HtmlAttribute(Value)        : HtmlName HtmlAttributeEqValue
HtmlAttribute(Bool)         : HtmlName
HtmlAttributeEqValue        : "=" HtmlAttributeValue
HtmlAttributeValue(Expr)    : TagExpression
HtmlAttributeValue          : HtmlQQString
HtmlAttributeValue          : HtmlQString
HtmlAttributeValue(Plain)   : HtmlPlainValue

HtmlName(ns)        : HtmlSimpleName ":" HtmlSimpleName
HtmlName            : HtmlSimpleName
HtmlSimpleName(d)   : HtmlSimpleName "-" HtmlNameWord
HtmlSimpleName      : HtmlNameWord

HtmlQQConst         : <"> HtmlQQText <">
HtmlQQConst(empty)  : <"> <">
HtmlQQString        : <"> HtmlQQContent <">
HtmlQQString(empty) : <"> <">
HtmlQQContent(loop) : HtmlQQContent HtmlQQContentPart
HtmlQQContent(first): HtmlQQContentPart
HtmlQQContentPart   : HtmlQQText
HtmlQQContentPart(E): TagExpression
HtmlQQText(loop)    : HtmlQQText HtmlQQTextPart
HtmlQQText(first)   : HtmlQQTextPart
HtmlQQTextPart(flow): HtmlFlowText
HtmlQQTextPart      : HtmlQQTextPartSpec

HtmlQConst          : <'> HtmlQText <'>
HtmlQConst(empty)   : <'> <'>
HtmlQString         : <'> HtmlQContent <'>
HtmlQString(empty)  : <'> <'>
HtmlQContent(loop)  : HtmlQContent HtmlQContentPart
HtmlQContent(first) : HtmlQContentPart
HtmlQContentPart    : HtmlQText
HtmlQContentPart(E) : TagExpression
HtmlQText(loop)     : HtmlQText HtmlQTextPart
HtmlQText(first)    : HtmlQTextPart
HtmlQTextPart(flow) : HtmlFlowText
HtmlQTextPart       : HtmlQTextPartSpec

Text(empty)         : .EolWithWs
Text                : .EolWithWs InlineTextWithEolWs
Text                : InlineTextWithEolWs
InlineTextWithEolWs : InlineText .EolWithWs
InlineTextWithEolWs : InlineText

Tag                     : "{{" TagContinueAny
TagExpression           : "{{" WsTagExpressionContinue
TagContinueAny(comment) : .CommentTagContinue
TagContinueAny          : WsTagContinue
CommentTagContinue      : "#" .CommentTagContent "#}}"
CommentTagContinue      : "#" "#}}"
WsTagContinue           : .ws TagContinue
WsTagContinue           : TagContinue
TagContinue(Empty)      : "}}"
TagContinue(Expr)       : TagExpressionContinue
TagContinue(St)         : "%" StatementContinue
WsTagExpressionContinue : .ws TagExpressionContinue
WsTagExpressionContinue : TagExpressionContinue
TagExpressionContinue   : Expression .WsTagEnd
StatementContinue(I)    : InlineStatementContinue
InlineStatementContinue : InlineStatement .WsTagEnd
WsTagEnd                : .ws "}}"
WsTagEnd                : "}}"

InlineStatement(unknown)    : name

Expression  : Variable

Variable    : "$" name

HtmlNameWord        : /(?i)[a-z][a-z0-9]*+/
name                : /(?i)[a-z_][a-z_0-9]*+/
ws                  : /\s++/
InlineText          : /(?:[^\s<>{}]++|\h++(?!\z|\R)|\{(?!\{)|\}(?!\}))++/
CommentTagContent   : /(?:[^#]++|#(?!\}\}))++/
HtmlQQTextPartSpec  : /[<>']++/
HtmlQTextPartSpec   : /[<>"]++/
EolWithWs           : /\h*+(?:\R\h*+)++/
HtmlPlainValue      : /[^<>'"={}\s]++/
HtmlFlowText        : /[^<>'"{}]++/
